<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ë£°ë ›</title>
  <style>
    :root{
      --bg:#f6f7fb; --card:#fff; --line:#e6e8ef; --text:#111; --muted:#666;
      --black:#111; --radius:16px;
    }
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;margin:0;background:var(--bg);color:var(--text)}
    .top{display:flex;align-items:center;justify-content:space-between;gap:10px;padding:14px 16px;background:#fff;border-bottom:1px solid var(--line)}
    .brand{display:flex;align-items:center;gap:10px;font-weight:900}
    .btn{border:1px solid #d7dae6;background:var(--black);color:#fff;border-radius:12px;padding:10px 12px;font-weight:800;cursor:pointer}
    .btn.secondary{background:#fff;color:var(--text)}
    .btn:disabled{opacity:.45;cursor:not-allowed}
    .chip{display:inline-flex;align-items:center;gap:8px;background:#fff;border:1px solid var(--line);border-radius:999px;padding:8px 10px;font-size:13px}
    .wrap{max-width:920px;margin:0 auto;padding:18px}
    .card{background:var(--card);border:1px solid var(--line);border-radius:var(--radius);padding:16px;margin:12px 0;box-shadow:0 6px 20px rgba(0,0,0,.04)}
    .row{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
    input{width:100%;max-width:360px;padding:12px;border-radius:12px;border:1px solid #d7dae6;font-size:16px}
    .msg{padding:10px 12px;border-radius:12px;border:1px solid var(--line);background:#fafbff;font-size:14px;white-space:pre-wrap}
    .msg.err{border-color:#ffd1d1;background:#fff5f5;color:#a40000}
    .msg.ok{border-color:#c9f3d1;background:#f3fff5;color:#0f6b1a}
    .muted{color:var(--muted);font-size:13px;line-height:1.5}
    .big{font-size:22px;font-weight:1000}
    .divider{height:1px;background:#eef0f6;margin:14px 0}
    .hidden{display:none!important}
    .secTitle{display:flex;align-items:baseline;justify-content:space-between;gap:12px}
    .secTitle h3{margin:0;font-size:18px}
    .pill{font-size:12px;color:#333;background:#f1f3f9;border:1px solid var(--line);padding:6px 10px;border-radius:999px}
    .results{margin-top:10px;display:grid;gap:8px}
    .resultLine{display:flex;align-items:center;justify-content:space-between;gap:10px;padding:10px 12px;border:1px solid var(--line);border-radius:12px;background:#fff}
    .resultLine b{font-weight:900}
    .tiny{font-size:12px;color:var(--muted)}
  </style>
</head>
<body>
  <div class="top">
    <div class="brand">ğŸ¯ ë£°ë ›</div>
    <div class="row" style="gap:8px">
      <a class="btn secondary" href="./log.html">ğŸ“Š ê¸°ë¡ ì‚¬ì´íŠ¸ë¡œ ì´ë™</a>
      <span id="meChip" class="chip hidden"></span>
      <button id="btnLogout" class="btn secondary hidden">ë¡œê·¸ì•„ì›ƒ</button>
    </div>
  </div>

  <div class="wrap">
    <div class="card">
      <div id="statusMsg" class="msg">ìŠ¤í¬ë¦½íŠ¸ ë¡œë”©ì¤‘â€¦</div>
      <div class="muted" style="margin-top:8px">
        âœ… ë£°ë ›ì€ <b>ê´€ë¦¬ìë§Œ</b> ëŒë¦´ ìˆ˜ ìˆì–´ìš”. (Firestore: <b>users/{uid}.role == "admin"</b>)
      </div>
    </div>

    <!-- Auth: ë¡œê·¸ì¸/íšŒì›ê°€ì… "ëª¨ë“œ ì „í™˜" -->
    <div id="authCard" class="card">
      <div class="secTitle">
        <h3 id="authTitle">ë¡œê·¸ì¸</h3>
        <span class="pill" id="authModePill">LOGIN</span>
      </div>
      <div class="divider"></div>

      <div class="row">
        <input id="email" type="email" placeholder="ì´ë©”ì¼" autocomplete="email" />
        <input id="pw" type="password" placeholder="ë¹„ë°€ë²ˆí˜¸" autocomplete="current-password" />
      </div>

      <div id="nicknameRow" class="row hidden" style="margin-top:10px">
        <input id="nickname" type="text" placeholder="ë‹‰ë„¤ì„(íšŒì›ê°€ì… ì‹œ í•„ìˆ˜)" autocomplete="nickname" />
      </div>

      <div class="row" style="margin-top:10px">
        <button id="btnPrimary" class="btn">ë¡œê·¸ì¸</button>
        <button id="btnToggleMode" class="btn secondary">íšŒì›ê°€ì…</button>
      </div>

      <div class="muted" style="margin-top:8px">
        * íšŒì›ê°€ì…í•˜ë©´ Firestore <b>users/{uid}</b> ë¬¸ì„œê°€ ìë™ ìƒì„±ë¼ìš”.
      </div>
    </div>

    <!-- Admin Only Area -->
    <div id="adminArea" class="hidden">
      <!-- 1) ê¸°ë³¸ ë£°ë › -->
      <div class="card">
        <div class="secTitle">
          <h3>ê¸°ë³¸ ë£°ë ›</h3>
          <span class="pill">NORMAL</span>
        </div>
        <div class="divider"></div>
        <div class="row">
          <span class="chip">ëª‡ íšŒ ëŒë¦´ê¹Œ?</span>
          <input id="cntNormal" type="number" min="1" max="200" value="1" style="max-width:140px" />
          <button id="spinNormal" class="btn" style="min-width:150px">ğŸ² ëŒë¦¬ê¸°</button>
          <span id="lastNormal" class="chip">ê²°ê³¼: -</span>
        </div>
        <div class="results" id="listNormal"></div>
      </div>

      <!-- 2) ê·€ì¡± ë£°ë › -->
      <div class="card">
        <div class="secTitle">
          <h3>ê·€ì¡± ë£°ë ›</h3>
          <span class="pill">NOBLE</span>
        </div>
        <div class="divider"></div>
        <div class="row">
          <span class="chip">ëª‡ íšŒ ëŒë¦´ê¹Œ?</span>
          <input id="cntNoble" type="number" min="1" max="200" value="1" style="max-width:140px" />
          <button id="spinNoble" class="btn" style="min-width:150px">ğŸ² ëŒë¦¬ê¸°</button>
          <span id="lastNoble" class="chip">ê²°ê³¼: -</span>
        </div>
        <div class="results" id="listNoble"></div>
      </div>

      <!-- 3) ì‹œê°„ ë£°ë › -->
      <div class="card">
        <div class="secTitle">
          <h3>ì‹œê°„ ë£°ë ›</h3>
          <span class="pill">TIME</span>
        </div>
        <div class="divider"></div>
        <div class="row">
          <span class="chip">ëª‡ íšŒ ëŒë¦´ê¹Œ?</span>
          <input id="cntTime" type="number" min="1" max="200" value="1" style="max-width:140px" />
          <button id="spinTime" class="btn" style="min-width:150px">ğŸ² ëŒë¦¬ê¸°</button>
          <span id="lastTime" class="chip">ê²°ê³¼: -</span>
        </div>
        <div class="results" id="listTime"></div>
      </div>

      <div class="card">
        <div class="muted">
          * ê²°ê³¼ëŠ” Firestore <b>logs</b> ì»¬ë ‰ì…˜ì— ì €ì¥ë¼ìš”.<br>
          * ê¸°ë¡ í˜ì´ì§€(log.html)ì—ì„œ ë‹‰ë„¤ì„ë³„ ì•„ì½”ë””ì–¸ìœ¼ë¡œ í™•ì¸ ê°€ëŠ¥.
        </div>
      </div>
    </div>

    <!-- Non-admin ì•ˆë‚´ -->
    <div id="nonAdminCard" class="card hidden">
      <div class="big">ë£°ë ›</div>
      <div class="muted">ê´€ë¦¬ìë§Œ ë£°ë ›ì„ ëŒë¦´ ìˆ˜ ìˆì–´ìš”.</div>
      <div class="divider"></div>
      <a class="btn secondary" href="./log.html">ğŸ“Š ê¸°ë¡ í˜ì´ì§€ë¡œ ì´ë™</a>
    </div>
  </div>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-app.js";
    import {
      getAuth, onAuthStateChanged,
      signInWithEmailAndPassword, createUserWithEmailAndPassword,
      signOut, setPersistence, browserLocalPersistence
    } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-auth.js";
    import {
      getFirestore, doc, getDoc, setDoc, serverTimestamp,
      collection, addDoc
    } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-firestore.js";

    // âœ… ë„ˆê°€ ì¤€ firebaseConfig (ê·¸ëŒ€ë¡œ)
    const firebaseConfig = {
      apiKey: "AIzaSyCgVETP2TbQOkDeh5D2ocwXhUMPcZYYKbs",
      authDomain: "roulette-b5455.firebaseapp.com",
      projectId: "roulette-b5455",
      storageBucket: "roulette-b5455.firebasestorage.app",
      messagingSenderId: "728191308035",
      appId: "1:728191308035:web:b14b46c38bbe0261969936",
      measurementId: "G-SPY41ZKXYQ"
    };

    const $ = (id) => document.getElementById(id);
    const statusMsg = $("statusMsg");
    function setStatus(text, type="") {
      statusMsg.textContent = text;
      statusMsg.className = "msg" + (type ? " " + type : "");
    }
    function show(el, yes){ el.classList.toggle("hidden", !yes); }

    // ===== ë£°ë › ëª©ë¡ =====
    const ROULETTES = {
      normal: [
        { text: "ëƒ¥ë©ì²´[3ë¶„]", w: 3.4 },
        { text: "ì›í•˜ëŠ”ì²´[3ë¶„_5ê¸€ì]", w: 3.4 },
        { text: "ì§§ì€ì• êµëŒ€ì‚¬[5ì¤„ ì´í•˜]", w: 1.7 },
        { text: "íŒ¬ë³´ë“œ", w: 1.7 },
        { text: "í˜€ë´‰ì¸[1ë¶„]", w: 3.4 },
        { text: "ë°›ì¹¨ë´‰ì¸[1ë¶„]", w: 3.4 },
        { text: "ì˜ ì–´ê¸ˆì§€[3ë¶„]", w: 3.4 },
        { text: "ì¹¨ë±‰ê¸°", w: 3.4 },
        { text: "ì§§ì€íŒ¬ë³´ë“œ[1~2ì¤„]", w: 3.4 },
        { text: "ì‹¤ë“œ+100", w: 2.3 },
        { text: "ì‹¤ë“œ-100", w: 2.3 },
        { text: "ASMRë°©ì†¡[3ë¶„]", w: 1.7 },
        { text: "ë£°ë › ë‹¤ëŒê¶Œ", w: 3.4 },
        { text: "í—¬ê¸° ë¦¬ì•¡[í‚µx]", w: 1.7 },
        { text: "ã…‡ë°›ì¹¨ì²´[2ë¶„]", w: 3.4 },
        { text: "ì¶œì„ì²´í¬ ë¦¬ì•¡[í‚µx]", w: 3.4 },
        { text: "ë¸Œë¼ë³´[í‚µx]", w: 3.4 },
        { text: "3ì¸ì¹­[1ë¶„]", w: 3.4 },
        { text: "ë°©ì¢…ê¹Œì§€ ì‰´ë“œ 0ê°œ[í‚µx]", w: 1.7 },
        { text: "ë°œë°•ìˆ˜", w: 3.4 },
        { text: "ë°©ì œ ë³€ê²½ê¶Œ[10ë¶„/í‚µ ë¶ˆê°€]", w: 1.7 },
        { text: "ë°°ê²½ì‚¬ì§„ ë³€ê²½ê¶Œ[10ë¶„/í‚µ ë¶ˆê°€]", w: 1.7 },
        { text: "ì—°í•˜ì¶©ì• êµë„ë¦¬[1ë¶„]", w: 1.7 },
        { text: "ë´‰ì¸ì¶”ê°€", w: 1.7 },
        { text: "ë´‰ì¸ì œê±°", w: 1.7 },
        { text: "ì´ì‘¤ì‹œê°œ ë¦¬ì•¡ì…˜[í‚µx]", w: 1.7 },
        { text: "ë°°í†µí†µ[í‚µx]", w: 3.4 },
        { text: "ê³µì§€ë³€ê²½ê¶Œ[ë‹¤ìŒ ë°©ì†¡ê¹Œì§€]", w: 1.7 },
        { text: "ë°•ìˆ˜ 3ë²ˆ[í‚µx]", w: 3.4 },
        { text: "íˆ¬ëª…ì˜ì 1ë¶„[í‚µx]", w: 1.7 },
        { text: "ìŠ¤ì¿¼íŠ¸ 5ê°œ[í‚µx]", w: 1.7 },
        { text: "ë²½ì°[í‚µx]", w: 3.4 },
        { text: "TMI 1ê°œ ì˜¬ë¦¬ê¸°", w: 3.4 },
        { text: "ì´ë¦„ 3ë²ˆ ë¶ˆëŸ¬ì£¼ê¸°", w: 1.7 },
        { text: "ê½", w: 12.1 }
      ],
      noble: (function(){
        const base = [
          { text: "24ì‹œê°„ ë‹‰ë³€ê¶Œ", w: 10 },
          { text: "24ì‹œê°„ ì—­ë‹‰ë³€ê¶Œ", w: 10 },
          { text: "ì›í•˜ëŠ” ë…¹ìŒë³¸ ë³´ë‚´ì£¼ê¸°[ì§§ì€ ì• êµ/ì›í•˜ëŠ” ëŒ€ì‚¬/ë¦¬ì•¡ì…˜]", w: 4 },
          { text: "ë‹¨ë… ë°•ì œí¸ì§€", w: 4 },
          { text: "ë£°ë › ì„ íƒê¶Œ[ê¸°ë³¸ or ê·€ì¡± ì¤‘ ì›í•˜ëŠ” ê²ƒ í•˜ë‚˜ ê³ ë¥´ê¸°]", w: 4 },
          { text: "ìºìŠ¤íŠ¸ ì €ì¥ê¶Œ 2íšŒ", w: 13 },
          { text: "ì‹¤ë“œ 2ë°°", w: 5 },
          { text: "ì‹¤ë“œí‘ 2ë°°", w: 5 }
        ];
        const sum = base.reduce((a,b)=>a+b.w,0);
        const remain = Math.max(0, 100 - sum);
        base.push({ text: "ê·€ì¡±ë£°ë › í• ì¸ê¶Œ(250ìŠ¤í‘¼,3ë¶„/ë³¸ì¸ë§Œ ì‚¬ìš© ê°€ëŠ¥)", w: remain });
        return base;
      })(),
      time: [
        { text: "ë°©ì†¡ ì—°ì¥ê¶Œ +1ë¶„", w: 41 },
        { text: "ë°©ì†¡ ì—°ì¥ê¶Œ +10ë¶„", w: 5 },
        { text: "ë°©ì†¡ ì—°ì¥ê¶Œ +20ë¶„", w: 3 },
        { text: "ë°©ì†¡ ì—°ì¥ê¶Œ +30ë¶„", w: 1 },
        { text: "ë°©ì†¡ ë‹¨ì¶•ê¶Œ -1ë¶„", w: 41 },
        { text: "ë°©ì†¡ ë‹¨ì¶•ê¶Œ -10ë¶„", w: 5 },
        { text: "ë°©ì†¡ ë‹¨ì¶•ê¶Œ -20ë¶„", w: 3 },
        { text: "ë°©ì†¡ ë‹¨ì¶•ê¶Œ -30ë¶„", w: 1 }
      ]
    };

    function pickWeighted(items){
      const total = items.reduce((a,b)=>a+b.w,0);
      const r = Math.random() * total;
      let acc = 0;
      for (const it of items){
        acc += it.w;
        if (r <= acc) return it.text;
      }
      return items[items.length-1]?.text ?? "-";
    }

    function clampInt(v, min, max){
      const n = parseInt(String(v||"").trim(), 10);
      if (Number.isNaN(n)) return min;
      return Math.max(min, Math.min(max, n));
    }

    function addResultLine(listEl, text){
      const line = document.createElement("div");
      line.className = "resultLine";
      line.innerHTML = `<b>${escapeHtml(text)}</b><span class="tiny">${new Date().toLocaleTimeString()}</span>`;
      listEl.prepend(line);
      // ë„ˆë¬´ ê¸¸ì–´ì§€ë©´ 30ê°œê¹Œì§€ë§Œ
      while (listEl.children.length > 30) listEl.removeChild(listEl.lastChild);
    }

    function escapeHtml(s){
      return String(s).replace(/[&<>"']/g, (c)=>({
        "&":"&amp;","<":"&lt;",">":"&gt;","\"":"&quot;","'":"&#39;"
      }[c]));
    }

    // ===== Firebase init =====
    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);

    // âœ… ì´ê²Œ ìˆì–´ì•¼ â€œë£°ë ›ì—ì„œ ë¡œê·¸ì¸í•˜ë©´ ë¡œê·¸ë„ ìë™ ë¡œê·¸ì¸â€ì´ ì•ˆì •ì ìœ¼ë¡œ ë¨
    await setPersistence(auth, browserLocalPersistence);

    setStatus("ìŠ¤í¬ë¦½íŠ¸ ë¡œë”© ì™„ë£Œ âœ…", "ok");

    // ===== users/{uid} ë¬¸ì„œ ë³´ì¥ =====
    async function ensureUserDoc(user, nicknameInput=""){
      const ref = doc(db, "users", user.uid);
      const snap = await getDoc(ref);
      if (!snap.exists()){
        const nick = (nicknameInput || "").trim() || (user.email ? user.email.split("@")[0] : "user");
        await setDoc(ref, {
          email: user.email || "",
          nickname: nick,
          role: "user",
          createdAt: serverTimestamp()
        }, { merge:true });
        return { email:user.email||"", nickname:nick, role:"user" };
      }
      const data = snap.data() || {};
      // ë³´ì •
      if (!data.email || data.email !== (user.email||"")){
        await setDoc(ref, { email: user.email || "" }, { merge:true });
      }
      return (await getDoc(ref)).data() || {};
    }

    async function getRole(user){
      const ref = doc(db, "users", user.uid);
      const snap = await getDoc(ref);
      const data = snap.exists() ? (snap.data()||{}) : {};
      return {
        role: data.role || "user",
        nickname: data.nickname || ""
      };
    }

    // ===== Auth UI mode (ë¡œê·¸ì¸/íšŒì›ê°€ì… ì „í™˜) =====
    let mode = "login"; // login | signup
    function setMode(next){
      mode = next;
      $("authModePill").textContent = mode.toUpperCase();
      if (mode === "login"){
        $("authTitle").textContent = "ë¡œê·¸ì¸";
        $("btnPrimary").textContent = "ë¡œê·¸ì¸";
        $("btnToggleMode").textContent = "íšŒì›ê°€ì…";
        show($("nicknameRow"), false);
      } else {
        $("authTitle").textContent = "íšŒì›ê°€ì…";
        $("btnPrimary").textContent = "ê°€ì… ì™„ë£Œ";
        $("btnToggleMode").textContent = "ë¡œê·¸ì¸ìœ¼ë¡œ";
        show($("nicknameRow"), true);
      }
    }
    setMode("login");

    $("btnToggleMode").addEventListener("click", ()=>{
      setMode(mode === "login" ? "signup" : "login");
      setStatus(mode === "signup" ? "íšŒì›ê°€ì… ëª¨ë“œë¡œ ì „í™˜ë¨" : "ë¡œê·¸ì¸ ëª¨ë“œë¡œ ì „í™˜ë¨", "ok");
    });

    $("btnPrimary").addEventListener("click", async ()=>{
      const email = $("email").value.trim();
      const pw = $("pw").value;

      if (!email || !pw){
        setStatus("ì´ë©”ì¼/ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì¤˜.", "err");
        return;
      }

      try{
        if (mode === "login"){
          setStatus("ë¡œê·¸ì¸ ì‹œë„ì¤‘â€¦");
          await signInWithEmailAndPassword(auth, email, pw);
        } else {
          const nick = $("nickname").value.trim();
          if (!nick){
            setStatus("íšŒì›ê°€ì…ì€ ë‹‰ë„¤ì„ì´ í•„ìš”í•´ìš”.", "err");
            return;
          }
          setStatus("íšŒì›ê°€ì… ì‹œë„ì¤‘â€¦");
          const cred = await createUserWithEmailAndPassword(auth, email, pw);
          await ensureUserDoc(cred.user, nick);
          setStatus("íšŒì›ê°€ì… ì™„ë£Œ âœ…", "ok");
        }
      }catch(e){
        setStatus(
          (mode === "login" ? "ë¡œê·¸ì¸ ì‹¤íŒ¨:\n" : "íšŒì›ê°€ì… ì‹¤íŒ¨:\n") +
          (e?.code || "") + "\n" + (e?.message || e),
          "err"
        );
      }
    });

    $("btnLogout").addEventListener("click", async ()=>{ await signOut(auth); });

    // ===== Spin handlers =====
    async function spinMany(type, count, lastEl, listEl){
      const user = auth.currentUser;
      if (!user){ setStatus("ë¡œê·¸ì¸ì´ í•„ìš”í•´ìš”.", "err"); return; }

      // ê´€ë¦¬ì ì‹¤ì‹œê°„ ì²´í¬
      const me = await getRole(user);
      if (me.role !== "admin"){
        setStatus("ê´€ë¦¬ìê°€ ì•„ë‹ˆì—ìš”. (users/{uid}.role == \"admin\" í•„ìš”)", "err");
        show($("adminArea"), false);
        show($("nonAdminCard"), true);
        return;
      }

      const items = ROULETTES[type];
      for (let i=0;i<count;i++){
        const result = pickWeighted(items);
        lastEl.textContent = "ê²°ê³¼: " + result;
        addResultLine(listEl, result);

        await addDoc(collection(db, "logs"), {
          uid: user.uid,
          email: user.email || "",
          nickname: me.nickname || "",
          rouletteType: type,
          result,
          createdAt: serverTimestamp()
        });
      }
      setStatus(`ì €ì¥ ì™„ë£Œ âœ… (${type} ${count}íšŒ)`, "ok");
    }

    $("spinNormal").addEventListener("click", async ()=>{
      const cnt = clampInt($("cntNormal").value, 1, 200);
      $("cntNormal").value = String(cnt);
      await spinMany("normal", cnt, $("lastNormal"), $("listNormal"));
    });
    $("spinNoble").addEventListener("click", async ()=>{
      const cnt = clampInt($("cntNoble").value, 1, 200);
      $("cntNoble").value = String(cnt);
      await spinMany("noble", cnt, $("lastNoble"), $("listNoble"));
    });
    $("spinTime").addEventListener("click", async ()=>{
      const cnt = clampInt($("cntTime").value, 1, 200);
      $("cntTime").value = String(cnt);
      await spinMany("time", cnt, $("lastTime"), $("listTime"));
    });

    // ===== Auth state =====
    onAuthStateChanged(auth, async (user)=>{
      if (!user){
        show($("authCard"), true);
        show($("btnLogout"), false);
        show($("meChip"), false);
        show($("adminArea"), false);
        show($("nonAdminCard"), false);
        $("meChip").textContent = "";
        setStatus("ë¯¸ë¡œê·¸ì¸ ìƒíƒœ", "");
        return;
      }

      try{
        const data = await ensureUserDoc(user, $("nickname").value.trim());
        const role = data.role || "user";
        const nick = data.nickname || "";

        show($("authCard"), false);
        show($("btnLogout"), true);
        show($("meChip"), true);
        $("meChip").textContent = `${nick || user.email} Â· ${role}`;

        if (role === "admin"){
          show($("adminArea"), true);
          show($("nonAdminCard"), false);
          setStatus("ê´€ë¦¬ì ë¡œê·¸ì¸ë¨ âœ…", "ok");
        } else {
          show($("adminArea"), false);
          show($("nonAdminCard"), true);
          setStatus("ë¡œê·¸ì¸ë¨ (ì¼ë°˜ ì‚¬ìš©ì)", "ok");
        }
      }catch(e){
        setStatus("ë¡œê·¸ì¸ í›„ ì²˜ë¦¬ ì‹¤íŒ¨:\n" + (e?.message || e), "err");
      }
    });
  </script>
</body>
</html>
