<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>ë£°ë › ë©”ì¸</title>
<style>
body {
  font-family: Arial, sans-serif;
  background: #f5f5f5;
  text-align: center;
  padding: 40px;
}
.box {
  background: white;
  padding: 20px;
  margin: 20px auto;
  width: 320px;
  border-radius: 10px;
}
input, button {
  margin-top: 6px;
}
button {
  padding: 8px 16px;
  border: none;
  border-radius: 6px;
  background: #4CAF50;
  color: white;
}
</style>
</head>
<body>

<h1>ğŸ¯ ë£°ë ›</h1>

ë‹‰ë„¤ì„<br>
<input id="nickname" placeholder="ë‹‰ë„¤ì„ ì…ë ¥"><br><br>

<div class="box">
  <h3>ì¼ë°˜ë£°ë ›</h3>
  íšŸìˆ˜ <input type="number" id="c1" value="1" min="1"><br>
  <button onclick="run(1,'ì¼ë°˜ë£°ë ›')">ì‹¤í–‰</button>
</div>

<div class="box">
  <h3>ê·€ì¡±ë£°ë ›</h3>
  íšŸìˆ˜ <input type="number" id="c2" value="1" min="1"><br>
  <button onclick="run(2,'ê·€ì¡±ë£°ë ›')">ì‹¤í–‰</button>
</div>

<div class="box">
  <h3>ì‹œê°„ ë£°ë ›</h3>
  íšŸìˆ˜ <input type="number" id="c3" value="1" min="1"><br>
  <button onclick="run(3,'ì‹œê°„ ë£°ë ›')">ì‹¤í–‰</button>
</div>

<script>
const items = Array.from({length:20},(_,i)=>i+1);

function run(type,name){
  const nick = document.getElementById("nickname").value.trim();
  if(!nick){ alert("ë‹‰ë„¤ì„ ì…ë ¥"); return; }

  const count = Number(document.getElementById("c"+type).value);
  let data = JSON.parse(localStorage.getItem("rouletteLog")) || {};

  if(!data[nick]) data[nick] = [];
  const stats = {};

  for(let i=0;i<count;i++){
    const r = items[Math.floor(Math.random()*20)];
    stats[r] = (stats[r]||0)+1;

    // âœ… ì—¬ê¸°ì„œ Firebaseì— â€œê° ë‹¹ì²¨ ê²°ê³¼â€ë¥¼ ì €ì¥
    saveToFirebase(r);
  }

  data[nick].push({
    roulette: name,
    count: count,
    stats: stats,
    time: new Date().toLocaleTimeString()
  });

  localStorage.setItem("rouletteLog", JSON.stringify(data));
  alert("ì €ì¥ ì™„ë£Œ! (ë¡œì»¬ + Firebaseì— ê¸°ë¡ë¨)");
}
</script>

<!-- ğŸ”½ğŸ”½ğŸ”½ ì—¬ê¸°ë¶€í„° Firebase ì €ì¥ ì½”ë“œ (ê±´ë“œë¦´ í•„ìš” ì—†ìŒ) ğŸ”½ğŸ”½ğŸ”½ -->
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-app.js";
  import { getFirestore, collection, addDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "AIzaSyBUMDicEPJ8AtHHe0LRBviIsKbYQJ4U5LA",
    authDomain: "roulette-log.firebaseapp.com",
    projectId: "roulette-log",
    storageBucket: "roulette-log.firebasestorage.app",
    messagingSenderId: "848295448204",
    appId: "1:848295448204:web:1b1cd13bf800a8409bf5a9",
    measurementId: "G-3FBMRDXR74"
  };

  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  // ê¸°ì¡´ ë£°ë › ê²°ê³¼ë¥¼ Firebaseì— ì €ì¥í•˜ëŠ” í•¨ìˆ˜
  window.saveToFirebase = async function(resultText) {
    await addDoc(collection(db, "rouletteLogs"), {
      result: String(resultText),
      ts: serverTimestamp(),
      byEmail: "ë„ë¦¬"
    });
  };
</script>

</body>
</html>